# Secrets-pentest

# Search Engine dorks
1. Shodan dorks: ssl.cert.subject.cn:"company.com" http.title:"admin"
2. Fofa dorks: cert="company.com" && title="admin"
3. ZoomEye dorks: ssl:company.com + title:"admin"
4. Censys dorks: (services.tls.certificates.leaf_data.issuer.common_name:company.com) AND services.http.response.html_title:admin

# Reconnaissance-Red-Teaming
https://dhiyaneshgeek.github.io/red/teaming/2022/04/28/reconnaissance-red-teaming/


| No |      Resources       |                  Website                 | # | No |     Resources      |                Website               |
|----|----------------------|------------------------------------------|---|----|-------------------|--------------------------------------|
| 1  |       Shodan         |         [https://www.shodan.io/](https://www.shodan.io/)       | # | 2  |       Wigle       |         [https://www.wigle.net/](https://www.wigle.net/)        |
| 3  |      GreyNoise       |       [https://www.greynoise.io/](https://www.greynoise.io/)     | # | 4  |     VirusTotal    | [https://www.virustotal.com/gui/home/upload](https://www.virustotal.com/gui/home/upload) |
| 5  |       URL Scan       |        [https://urlscan.io/](https://urlscan.io/)       | # | 6  |      Vulners      |          [https://vulners.com/](https://vulners.com/)         |
| 7  |   WayBackMachine     |    [https://web.archive.org/](https://web.archive.org/)     | # | 8  |       Netlas      |         [https://netlas.io/](https://netlas.io/)         |
| 9  |        ONYPHE        |        [https://www.onyphe.io/](https://www.onyphe.io/)       | # | 10 |      FullHunt     |        [https://fullhunt.io/](https://fullhunt.io/)       |
| 11 |       GrepApp        |       [https://grep.app/](https://grep.app/)        | # | 12 |       CRT sh      |        [https://crt.sh/](https://crt.sh/)        |
| 13 |   GreyHatWarfare     |   [https://grayhatwarfare.com/](https://grayhatwarfare.com/)   | # | 14 |     AlienVault    | [https://otx.alienvault.com/](https://otx.alienvault.com/) |
| 15 |     BinaryEdge       |      [https://www.binaryedge.io/](https://www.binaryedge.io/)     | # | 16 |       TinEye      |        [https://tineye.com/](https://tineye.com/)        |
| 17 |   OSINT Framework    |   [https://osintframework.com/](https://osintframework.com/)   | # | 18 |     Hunter.io     |      [https://hunter.io/](https://hunter.io/)      |
| 19 |       LeakIX         |        [https://leakix.net/](https://leakix.net/)       | # | 20 |   IntelligenceX   |     [https://intelx.io/](https://intelx.io/)     |
| 21 |     DNSDumpster      |     [https://dnsdumpster.com/](https://dnsdumpster.com/)     | # | 22 |      ExploitDB    |   [https://www.exploit-db.com/](https://www.exploit-db.com/)   |
| 23 |         CVE          |       [https://cve.mitre.org/](https://cve.mitre.org/)       | # | 24 |   Packet Storm    | [https://packetstormsecurity.com/](https://packetstormsecurity.com/) |

# Leakix
- https://leakix.net/search?scope=leak&q=%22microsoft.com%22
```
python leakix.py -d microsoft.com
python leakix.py -l domains.txt
```

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/27840b10-b561-464c-a509-4bca8ca2f769)

# Google Dorks for Bug Bounty
- https://github.com/IvanGlinkin/Fast-Google-Dorks-Scan

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/1b98f6c9-616b-42c9-ba82-8dc5d2e9b07d)


- https://reewardius.github.io/bugbounty-dorks/

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/934dfe5d-e30a-4ac7-8986-201bd811ea5c)

- https://dorks.faisalahmed.me/
- https://abhijithb200.github.io/investigator/
- https://dorkking.blindf.com/

# Fast AWS / GCP / Azure Bucket Finder
- https://github.com/initstring/cloud_enum

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/a65af904-ebe0-4949-836b-9b84b9bd2047)

- https://osint.sh/buckets/
- https://buckets.grayhatwarfare.com/files?keywords=tesla.com
# Blind XSS
- https://husseinphp.github.io/#
- https://github.com/dirtycoder0124/form_finder

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/c64a7caa-9c9a-4c19-86b6-f633a52a1a7b)

# Github dorking
- https://vsec7.github.io/
# Shodan dorking
- https://mr-koanti.github.io/shodan#f

- https://0iq.me/gip/ - Limiting google search to IP addresses bringing interesting results
  
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/8f7209e7-941b-418e-9b06-323e5579af19)

# Postman leaks
- https://www.postman.com/search?q=tesla.com&scope=public&type=all

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/3eb81b77-e0a6-4344-97ea-989a5b18d425)

# Nuclei

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/1b01e5e7-ae68-4d28-8200-ec1142f57137)

# Katana + URO + Nuclei + Fuzzing-Templates
```
katana -u domains -passive -f qurl -o katana; uro -i katana -o tofuzzing; nuclei -l tofuzzing -tags dast -rl 500 -c 100 -pc 50 -silent -fuzz -o fuzzing-results

katana -u domains -f qurl -fdc 'contains(to_lower(technologies), "cloudflare") || contains(to_lower(technologies), "akamai")' -o katana; uro -i katana -o tofuzzing; nuclei -l tofuzzing -tags dast -rl 500 -c 100 -pc 50 -silent -fuzz -o fuzzing-results
```
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/71ffc7ce-2e62-4fd8-b6b7-bb886d037169)

# Katana (Sensitive Endpoints)
```
katana -u domains -d 5 -jc -jsl -aff -kf all -mrs 5242880 -timeout 15 -retry 3 -s breadth-first -iqp -mdc 'contains(endpoint,"api") || contains(endpoint,"admin") || contains(endpoint,"user")' -dr -silent -o endpoints

httpx -l endpoints -title -sc -lc -nc -silent | sed 's/[][]//g' | awk '$NF > 20' | egrep '200|301|302'
```
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/c6e3cfed-1560-4a0f-a3fb-6274fa768781)

# Burp Suite + Ffuf + ffufPostprocessing + GAP
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/aad2a371-347d-4921-84b9-3504a9f1dd9b)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/fc2f6ccd-c239-4386-8172-b4e57ddd408f)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/dbf971ee-2d8a-4692-8703-47865501a473)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/6f3f7b03-e563-4d63-b62f-e02ed47f2f80)
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/bceb3d5d-8e5d-45ff-a37a-14b9f0ab6007)

Once GAP finishes. Copy out your links and feed them into file that you will run FFUF against. In my case, I filter by "/api", "/admin" and "/user". This is usually the juiciest data.
```
./ffuf -w "GAPoutput.txt" -u "FUZZ" -noninteractive -o "/tmp/results.json" -od "/tmp/bodies/" -of json
./ffufPostprocessing -result-file "/tmp/results.json" -bodies-folder "/tmp/bodies/" -delete-bodies -overwrite-result-file
jq -r '.results[].url' "/tmp/results.json" | httpx -title -sc -lc -nc -silent | sed 's/[][]//g' | awk '$NF > 20' | egrep '200|301|302'
jq -r '.results[].url' "/tmp/results.json" | nuclei -tags token,tokens -es unknown
```

