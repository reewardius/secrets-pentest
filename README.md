# Secrets-pentest

# Search Engine dorks
1. Shodan dorks: ssl.cert.subject.cn:"company.com" http.title:"admin"
2. Fofa dorks: cert="company.com" && title="admin"
3. ZoomEye dorks: ssl:company.com + title:"admin"
4. Censys dorks: (services.tls.certificates.leaf_data.issuer.common_name:company.com) AND services.http.response.html_title:admin

# Ffuf Search

1. admin-FUZZ.target.com E.G: admin-stg.target.com
2. FUZZ-admin.target.com E.G: cert-admin.target.com
3. adminFUZZ.target.com  E.G: admintest.target.com
4. FUZZadmin.target.com  E.G  testadmin.target.com
5. admin.FUZZ.target.com E.G: admin.dev.target.com

```
ffuf -w path/to/wordlist.txt -u 'https://adminFUZZ.target.com' -c -mc all -t 100
```

# Reconnaissance-Red-Teaming
https://dhiyaneshgeek.github.io/red/teaming/2022/04/28/reconnaissance-red-teaming/

| № |     Resources     |                       Website                      |  № |    Resources    |                      Website                     |
|----|-------------------|---------------------------------------------------|----|-----------------|--------------------------------------------------|
| 1  |      Shodan       |   [Shodan](https://www.shodan.io/)               | 2  |    GreyNoise    |   [GreyNoise](https://www.greynoise.io/)         |
| 3  |  WayBackMachine   | [WayBackMachine](https://web.archive.org/)       | 4  |     Netlas      |     [Netlas](https://netlas.io/)                |
| 5  |     GrepApp       |   [GrepApp](https://grep.app/)                   | 6  |     CRT sh      |     [CRT sh](https://crt.sh/)                   |
| 7  | GreyHatWarfare    | [GreyHatWarfare](https://grayhatwarfare.com/)   | 8 |   BinaryEdge    |  [BinaryEdge](https://www.binaryedge.io/)       |
| 9 | OSINT Framework   | [OSINT Framework](https://osintframework.com/)  | 10 |   Hunter.io     |  [Hunter.io](https://hunter.io/)                |
| 11 |      LeakIX       |   [LeakIX](https://leakix.net/)                 | 12 | IntelligenceX  | [IntelligenceX](https://intelx.io/)            |
| 13 |   DNSDumpster     | [DNSDumpster](https://dnsdumpster.com/)         | 14 | SecurityTrails  | [SecurityTrails](https://securitytrails.com/)  |         


# Useful Extensions

| Название          | Ссылка                                                                                          |
|-------------------|-------------------------------------------------------------------------------------------------|
| Wappalyzer        | [Wappalyzer](https://chromewebstore.google.com/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg?hl=ru) |
| TruffleHog Chrome | [TruffleHog Chrome](https://chromewebstore.google.com/detail/trufflehog/bafhdnhjnlcdbjcdcnafhdcphhnfnhjc) |
| TruffleHog Firefox| [TruffleHog Firefox](https://addons.mozilla.org/en-US/firefox/addon/trufflehog/)                |
| DotGit            | [DotGit](https://chromewebstore.google.com/detail/dotgit/pampamgoihgcedonnphgehgondkhikel?hl=ru) |
| Open Multiple Urls| [Open Multiple Urls](https://chromewebstore.google.com/detail/open-multiple-urls/oifijhaokejakekmnjmphonojcfkpbbh) |
| debugHunter       | [debugHunter](https://github.com/devploit/debugHunter)                                          |
| S3BucketList      | [S3BucketList](https://github.com/AlecBlance/S3BucketList)                                      |
| Web Archive       | [Web Archive](https://github.com/husseinphp/web-archive)                                        |
| Shodan            | [Shodan](https://chromewebstore.google.com/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap)      |
| BuiltWith            | [BuiltWith](https://chromewebstore.google.com/detail/builtwith-technology-prof/dapjbgnjinbpoindlpdmhochffioedbn?hl=en)

# Leakix
- https://leakix.net/search?scope=leak&q=%22microsoft.com%22
```
python leakix.py -d microsoft.com
python leakix.py -l domains.txt
```

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/27840b10-b561-464c-a509-4bca8ca2f769)

# Google Dorks for Bug Bounty
- https://github.com/IvanGlinkin/Fast-Google-Dorks-Scan

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/1b98f6c9-616b-42c9-ba82-8dc5d2e9b07d)


- https://reewardius.github.io/bugbounty-dorks/

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/934dfe5d-e30a-4ac7-8986-201bd811ea5c)

- https://dorks.faisalahmed.me/
- https://abhijithb200.github.io/investigator/
- https://dorkking.blindf.com/

# Atlassian

```
site:"<company>.atlassian.net" inurl:"/wiki"
```

# Fast AWS / GCP / Azure Bucket Finder
- https://github.com/initstring/cloud_enum

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/a65af904-ebe0-4949-836b-9b84b9bd2047)

- https://github.com/sa7mon/S3Scanner
- https://osint.sh/buckets/
- https://buckets.grayhatwarfare.com/files?keywords=tesla.com
# Blind XSS
- https://husseinphp.github.io/#
- https://github.com/dirtycoder0124/form_finder

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/c64a7caa-9c9a-4c19-86b6-f633a52a1a7b)

# Github dorking
- https://vsec7.github.io/
# Shodan dorking
- https://mr-koanti.github.io/shodan
  
# Public Interesting Info
- https://0iq.me/gip/ - Limiting google search to IP addresses bringing interesting results
  
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/8f7209e7-941b-418e-9b06-323e5579af19)

# Postman leaks
- https://www.postman.com/search?q=tesla.com&scope=public&type=all

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/3eb81b77-e0a6-4344-97ea-989a5b18d425)

# Katana + Nuclei (Secrets + Vulnerabilities)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/3873f28b-6583-48e5-b523-d6d4c2f39b4e)

```
katana -u domains -d 5 -s breadth-first -c 25 -dr -iqp -nc -f ufile -jc -em js,json -kf all -silent -o js_secrets; nucei -l js_secrets -tags token,tokens -es unknown -rl 500 -c 100 -silent -o secret-results

katana -u domains -passive -f qurl -em js,json -o katana_js; uro -i katana_js -o tosecrets; nuclei -l tosecrets -tags token,tokens -es unknown -rl 500 -c 100 -silent -o secret-results

katana -u domains -d 5 -s breadth-first -c 25 -dr -iqp -silent -nc -f udir -rl 500 -jc -ef js,css -kf all -o tonuclei; nuclei -l tonuclei -silent -s medium,high,critical -rl 500 -c 100 -o nuclei-vuls
```

# Katana + URO + Nuclei + Fuzzing-Templates
```
katana -u domains -passive -f qurl -o katana; uro -i katana -o tofuzzing; nuclei -l tofuzzing -tags dast -rl 500 -c 100 -pc 50 -silent -fuzz -o fuzzing-results

katana -u domains -f qurl -jc -jsl -d 5 -kf all -ct 5m -fdc 'contains(to_lower(technologies), "cloudflare") || contains(to_lower(technologies), "akamai")' -o katana; uro -i katana -o tofuzzing; nuclei -l tofuzzing -tags dast -rl 500 -c 100 -pc 50 -silent -fuzz -o fuzzing-results
```
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/71ffc7ce-2e62-4fd8-b6b7-bb886d037169)

# Katana (Sensitive Endpoints)
```
katana -u domains -d 5 -s breadth-first -rl 500 -c 50 -dr -iqp -nc -f ufile -jc -jsl -kf all -silent -o secrets_file

katana -u domains -d 5 -jc -jsl -aff -rl 250 -c 20 -kf all -mrs 5242880 -timeout 15 -retry 3 -s breadth-first -iqp -mdc 'contains(endpoint,"api") || contains(endpoint,"admin") || contains(endpoint,"user")' -dr -silent -o endpoints

httpx -l endpoints -title -sc -lc -nc -silent | sed 's/[][]//g' | awk '$NF > 20' | egrep '200|301|302'
```
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/c6e3cfed-1560-4a0f-a3fb-6274fa768781)

# Burp Suite + Ffuf + ffufPostprocessing + GAP
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/aad2a371-347d-4921-84b9-3504a9f1dd9b)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/fc2f6ccd-c239-4386-8172-b4e57ddd408f)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/dbf971ee-2d8a-4692-8703-47865501a473)

![image](https://github.com/reewardius/secrets-pentest/assets/68978608/6f3f7b03-e563-4d63-b62f-e02ed47f2f80)
![image](https://github.com/reewardius/secrets-pentest/assets/68978608/bceb3d5d-8e5d-45ff-a37a-14b9f0ab6007)

Once GAP finishes. Copy out your links and feed them into file that you will run FFUF against. In my case, I filter by "/api", "/admin" and "/user". This is usually the juiciest data.
```
./ffuf -w "GAPoutput.txt" -u "FUZZ" -noninteractive -o "/tmp/results.json" -od "/tmp/bodies/" -of json
./ffufPostprocessing -result-file "/tmp/results.json" -bodies-folder "/tmp/bodies/" -delete-bodies -overwrite-result-file
jq -r '.results[].url' "/tmp/results.json" | httpx -title -sc -lc -nc -silent | sed 's/[][]//g' | awk '$NF > 20' | egrep '200|301|302'
jq -r '.results[].url' "/tmp/results.json" | nuclei -tags token,tokens -es unknown
```

